#!/usr/bin/env bash
set -e

# Read current version from pyproject.toml
VERSION=$(grep '^version = ' pyproject.toml | sed 's/version = "\(.*\)"/\1/')

# Split version into parts
IFS='.' read -r MAJOR MINOR PATCH <<< "$VERSION"

# Increment patch version
NEW_PATCH=$((PATCH + 1))
NEW_VERSION="${MAJOR}.${MINOR}.${NEW_PATCH}"

# Update pyproject.toml
sed -i "s/^version = \".*\"/version = \"${NEW_VERSION}\"/" pyproject.toml

# Update __init__.py
sed -i "s/^__version__ = \".*\"/__version__ = \"${NEW_VERSION}\"/" src/codeup/__init__.py

echo "Version bumped from ${VERSION} to ${NEW_VERSION}"
